(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{gAmC:function(e,t,a){"use strict";a.r(t),a.d(t,"UsersModule",(function(){return j}));var s=a("ofXK"),i=a("tyNb"),r=a("mrSG"),o=a("ODCe"),n=a("b1el"),l=a("0iDv"),c=a("sYSY"),u=a("rAgn"),d=a("Ppxc"),b=a("fXoL"),p=a("UdEE"),m=a("0nJ8"),v=a("q3Kh"),f=a("vqVJ"),h=a("/IUn");let y=(()=>{class e extends m.a{constructor(e,t){super(t),this.usersService=e}register(e){return this.usersService.register(e)}update(e){return this.set(p.e,{user:e,include:!1}).pipe(Object(v.map)(e=>e.updateUser))}unblock(e,t=!1,a=!1){return this.set(p.c,{id:e,unblock:t,admin:a},{}).pipe(Object(v.map)(e=>e.blockUser))}sendEmailActive(e,t){return this.set(p.a,{id:e,email:t}).pipe(Object(v.map)(e=>e.activeUserEmail))}}return e.\u0275fac=function(t){return new(t||e)(b.Xb(f.a),b.Xb(h.a))},e.\u0275prov=b.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var A=a("egAa"),O=a("hrBI");const g=[{path:"",component:(()=>{class e{constructor(e,t){this.service=e,this.titleService=t,this.query=o.c,this.filterActiveValues=u.a.ACTIVE}ngOnInit(){this.titleService.updateTitle(d.a.USERS),this.context={},this.itemsPage=10,this.resultData={listKey:"users",definitionKey:"users"},this.include=!0,this.columns=[{property:"id",label:"#"},{property:"name",label:"Nombre"},{property:"lastname",label:"Apellidos"},{property:"email",label:"Correo electr\xf3nico"},{property:"role",label:"Permisos"},{property:"active",label:"\xbfActivos?"}]}initializeForm(e){const t=void 0!==e.name&&""!==e.name?e.name:"",a=void 0!==e.lastname&&""!==e.lastname?e.lastname:"",s=void 0!==e.email&&""!==e.email?e.email:"",i=new Array(2);return i[0]=void 0!==e.role&&"ADMIN"!==e.role?"selected":"",i[1]=void 0!==e.role&&"CLIENT"!==e.role?"selected":"",`\n    <input id="name" value="${t}" placeholder="Nombre" class="swal2-input" required>\n    <input id="lastname" value="${a}" placeholder="Apellido" class="swal2-input" required>\n    <input id="email" value="${s}" placeholder="Correo Electronico" class="swal2-input" required>\n    <select id="role" class="swal2-input">\n      <option value="ADMIN" ${i[0]}>Administrador</option>\n      <option value="ADMIN" ${i[0]}>Cliente</option>\n    </select>\n`}takeAction(e){return Object(r.b)(this,void 0,void 0,(function*(){const t=e[0],a=e[1],s=this.initializeForm(a);switch(t){case"add":this.addForm(s);break;case"edit":this.updateForm(s,a);break;case"info":const e=yield Object(n.e)("Detalles",`${a.name} ${a.lastname} </br>\n          <i class="fas fa-user-tag"></i>&nbsp;${a.role} </br>\n          <i class="far fa-calendar-alt"></i>&nbsp;${a.birthday} </br>\n          <i class="fas fa-envelope-open-text"></i>&nbsp;${a.email} </br>`,0!=a.active?425:445,'<i class="fas fa-edit"></i> Editar',0!=a.active?'<i class="fas fa-lock"></i> Bloquear':'<i class="fas fa-lock-open"></i> Desbloquear');e?this.updateForm(s,a):!1===e&&this.unblockForm(a,!1===a.active);break;case"block":this.unblockForm(a,!1);break;case"unblock":this.unblockForm(a,!0)}}))}addForm(e){return Object(r.b)(this,void 0,void 0,(function*(){const t=yield Object(n.f)("A\xf1adir usuario",e);this.addUser(t)}))}addUser(e){if(e.value){const t=e.value;t.password="1234",t.active=!1,this.service.register(t).subscribe(e=>{if(e.status)return Object(l.a)(c.a.SUCCESS,e.message),void this.service.sendEmailActive(e.user.id,t.email).subscribe(e=>{e.status?Object(l.a)(c.a.SUCCESS,e.message):Object(l.a)(c.a.WARNING,e.message)});Object(l.a)(c.a.WARNING,e.message)})}}updateForm(e,t){return Object(r.b)(this,void 0,void 0,(function*(){const a=yield Object(n.f)("Modificar usuario",e);this.updateUser(a,t.id)}))}updateUser(e,t){e.value&&(e.value.id=t,this.service.update(e.value).subscribe(e=>{e.status?Object(l.a)(c.a.SUCCESS,e.message):Object(l.a)(c.a.WARNING,e.message)}))}unblockForm(e,t){return Object(r.b)(this,void 0,void 0,(function*(){!1===(t?yield Object(n.e)("\xbfDesbloquear?","Si desbloqueas el usuario seleccionado, se mostrara en la lista y podra hacer compras",520,"No, no desbloquear","Si, desbloquear"):yield Object(n.e)("\xbfBloquear?","Si bloqueas el usuario seleccionado, no se mostrar\xe1 en la lista",520,"No, no bloquear","Si, bloquear"))&&this.unblockUser(e.id,t,!0)}))}unblockUser(e,t=!1,a=!1){this.service.unblock(e,t,a).subscribe(e=>{e.status?Object(l.a)(c.a.SUCCESS,e.message):Object(l.a)(c.a.WARNING,e.message)})}}return e.\u0275fac=function(t){return new(t||e)(b.Kb(y),b.Kb(A.a))},e.\u0275cmp=b.Eb({type:e,selectors:[["app-users"]],decls:2,vars:7,consts:[[3,"query","context","itemsPage","resultData","include","tableColumns","filterActiveValues","manageItem"]],template:function(e,t){1&e&&(b.Pb(0,"app-table-pagination",0),b.ac("manageItem",(function(e){return t.takeAction(e)})),b.Ob(),b.Ac(1,"\n")),2&e&&b.ic("query",t.query)("context",t.context)("itemsPage",t.itemsPage)("resultData",t.resultData)("include",t.include)("tableColumns",t.columns)("filterActiveValues",t.filterActiveValues)},directives:[O.a],styles:[".fa-lock-open[_ngcontent-%COMP%]{color:#28a745}"]}),e})()}];let k=(()=>{class e{}return e.\u0275mod=b.Ib({type:e}),e.\u0275inj=b.Hb({factory:function(t){return new(t||e)},imports:[[i.e.forChild(g)],i.e]}),e})();var S=a("OwPx");let j=(()=>{class e{}return e.\u0275mod=b.Ib({type:e}),e.\u0275inj=b.Hb({factory:function(t){return new(t||e)},imports:[[s.c,k,S.a]]}),e})()}}]);